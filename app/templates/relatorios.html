{% extends "base.html" %}

{% block title %}Central de Relatórios - GestãoPRO{% endblock %}

{% block content %}
<header class="main-header">
    <h1>Central de Relatórios e Impressões</h1>
    <p class="subtitle">Selecione um relatório, configure as opções e gere um PDF para visualização ou impressão.</p>
</header>

<div class="card full-width">
    <h2>Relatórios Disponíveis</h2>

    <div class="report-selection-grid">
        {# O loop 'relatorios' é fornecido pelo contexto Flask #}
        {% for key, config in relatorios.items() %}
            {# INCLUSÃO DO COMPONENTE DE ITEM DE RELATÓRIO #}
            {% include '_relatorio_item.html' with context %}
        {% endfor %}
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
function gerarRelatorio(nomeRelatorio) {
    const selectOrdenacao = document.getElementById(`ordenacao-${nomeRelatorio}`);
    const ordenacao = selectOrdenacao.value;
    
    // O endpoint /api/relatorios/{nome_relatorio}?ordenacao={valor} está correto para o FastAPI.
    const url = `/api/relatorios/${nomeRelatorio}?ordenacao=${ordenacao}`;
    
    window.open(url, '_blank');
}
</script>
{% endblock %}